<doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Chinese Annotator for Microsoft Word</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  </head>
  <body>
    <div class="wrapper">
		<!--
      <header>
        <h1 class="header">Chinese Annotator for Microsoft Word</h1>
        <p class="header">A Microsoft Word add-in for adding tone graphs, pinyin or zhuyin to Hanzi（汉字）. </p>

        <ul>
          <li class="download"><a class="buttons" href="https://raw.githubusercontent.com/twighk/tghz-word-tone-annotator/master/Publish/setup.exe">Installer</a></li>
          <li><a class="buttons github" href="https://github.com/twighk/tghz-word-tone-annotator">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/twighk">twighk</a></p>


      </header>
	  -->
      <section>
        <h1>
<a id="chinese-annotator-for-microsoft-word" class="anchor" href="#chinese-annotator-for-microsoft-word" aria-hidden="true"><span class="octicon octicon-link"></span></a>Chinese Annotator for Microsoft Word</h1>

<p>A Microsoft Word add-in for adding tone graphs, pinyin or zhuyin to Hanzi（汉字）.</p>

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/Welcome.png" alt="Welcome Example with Tones">

<p>The tones are automatically placed above the chinese characters, by the computer using a dictionary (<a href="http://www.mdbg.net/chindict/chindict.php?page=cedict">CC-CEDICT</a>) for the longest word it can find. If it is unsure of the tones, it will place multiple tones above the character (here 好， as 大家好 is not in the dictionary as one word).</p>

<p>To annotate tones for <a href="http://www.latex-project.org/">LaTeX</a>, see <a href="https://github.com/twighk/hanzi2tghz">hanzi2tghz</a>.</p>
<p>This project is hosted on <a href="https://github.com/twighk/tghz-word-tone-annotator">GitHub</a>. </p>

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/WelcomePinyin.png" alt="Welcome Example with Pinyin">

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/WelcomeZhuyin.png" alt="Welcome Example with Zhuyin Fuhao">


<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<ol>
    <li>Download and run <a href="https://raw.githubusercontent.com/twighk/tghz-word-tone-annotator/master/Publish/setup.exe">the installer</a>.</li>
    <ul>
        <li> There will Almost certainly be a certificate error so please follow:
            <p style="text-indent: 2em;"><a href="#troubleshooting">Troubleshooting</a></p>
        </li>
    </ul>
    <li>Open Word and the hanzi2tghz ribbon should be there. </li>
    <li>If any of the previous steps failed, <em>please</em> write about them on the <a href="https://github.com/twighk/tghz-word-tone-annotator/issues">issues</a> page or  <a href="http://www.google.com/recaptcha/mailhide/d?k=01mQf3KmE1mGHm1vIP541YEg==&c=M0ebLv9ye1RjVVWraxQtQUpmo5hN2NmexsBaDGvibxs=">email me</a>.</li>
    <li>Read the documentation, to see what it can do.</li>
    <li>Any feedback would be much appreciated. Please write about it on the  <a href="https://github.com/twighk/tghz-word-tone-annotator/issues">issues</a> page or  <a href="http://www.google.com/recaptcha/mailhide/d?k=01mQf3KmE1mGHm1vIP541YEg==&c=M0ebLv9ye1RjVVWraxQtQUpmo5hN2NmexsBaDGvibxs=">email me</a>.</li>
</ol>

<h2>
<a id="documentation" class="anchor" href="#documentation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Documentation</h2>

<p>Before use, please remember to make a backup of your document, just in case.</p>

<h3>
<a id="contents" class="anchor" href="#contents" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contents</h3>

<ol class="tocList">
<li>
<a href="#tones-pinyin-or-zhuyin-fuhao">Tones, Pinyin or Zhuyin Fuhao</a>

<ol>
<li><a href="#adding">Adding</a></li>
<li><a href="#removing">Removing</a></li>
<li><a href="#editing">Editing</a></li>
</ol>
</li>
<li><a href="#resizing-text">Resizing Text</a></li>
<li>
<a href="#dictionary-correction">Dictionary Correction</a>

<ol>
<li><a href="#enabling-dictionary-correction">Enabling Dictionary Correction</a></li>
<li><a href="#editing-the-corrections-dictionary">Editing the Corrections Dictionary</a></li>
<li><a href="#importing-and-exporting">Importing and Exporting</a></li>
</ol>
</li>
<li><a href="#colouring-tones">Colouring Tones</a></li>
<li><a href="#converting-traditionalsimplified-characters">Converting Traditional/Simplified Characters</a></li>
<li>
<a href="#troubleshooting">Troubleshooting</a>

<ol>
<li><a href="#certificate-error">Certificate Error</a></li>
<li><a href="#visual-studio-tools-for-office-solution-installer-error">Visual Studio Tools for Office Solution Installer Error</a></li>
<li><a href="#other-problems">Other Problems</a></li>
</ol>
</li>
</ol>

<h3>
<a id="tones-pinyin-or-zhuyin-fuhao" class="anchor" href="#tones-pinyin-or-zhuyin-fuhao" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tones, Pinyin or Zhuyin Fuhao</h3>

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/Tones%20or%20Pinyin.png" alt="">

<h4>
<a id="adding" class="anchor" href="#adding" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding</h4>

<p>To add tones or pinyin to text select some, or all the text (<code>Ctrl+a</code>), and press either the <code>Add Tones</code>, <code>Add Pinyin</code> or <code>Add Zhuyin</code> Button. When the dictionary finds multiple pronunciations for tones it puts multiple tones. For Pinyin or Zhuyin, it duplicates the words with the various pronuciations. To reduce duplicates use the Dictionary Correction utilities.</p>

<p>When tones or pinyin are added, all the font information about the text before is lost, so the size, colour, font, etc. are reset to the default.   </p>

<h4>
<a id="removing" class="anchor" href="#removing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Removing</h4>

<p>When removing tones or pinyin, it is preferable to use the <code>undo</code> button, to undo the previous action of adding them. For tones, the <code>Remove Tones/Pinyin</code> button can be used, but it can be problematic for pinyin, as it does not remove the duplicated characters caused by converting to pinyin. </p>

<h4>
<a id="editing" class="anchor" href="#editing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Editing</h4>

<p>To edit tones or pinyin, click on or select some text, then press the <code>Edit Tones or Pinyin</code> button and the incorrectly named <code>Edit Text or Pinyin</code> window should appear.</p>

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/EditTextOrPinyin.png" alt="">

<p>Here 大家好 has tones, and 欢迎来到我的网站 has pinyin. For tones, put the number of the tone or tones, in the text box on the right. For pinyin put the pinyin followed by the tone number.</p>

<h3>
<a id="resizing-text" class="anchor" href="#resizing-text" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resizing Text</h3>

<p>When the text is resized the tone/pinyin do not scale with the text size. The solution is to use one of the <code>resize</code> buttons.</p>

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/Resize.png" alt="">

<h4>
<a id="pinyin-or-zhuyin-fuhao" class="anchor" href="#pinyin-or-zhuyin-fuhao" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pinyin or Zhuyin Fuhao</h4>

<p>To resize pinyin or zhuyin fuhao, use the <code>Pinyin Resize:</code> button. The number next to it (<code>0.5</code> is the default) is the relative size of the text compared to the characters, i.e. <code>0.5</code> is half the size, <code>1.0</code> is the same size.</p>

<h4>
<a id="tones" class="anchor" href="#tones" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tones</h4>

<p>For Tones there are two issues the size of the tones and the height of the tones above the characters. For the size of the tones use the <code>Tone Resize:</code> button and change the relative size if you wish. For the height of the tones, change the number next to the <code>Tone Height:</code> button (<code>12</code> is the default, make it larger for larger text), then click the <code>Tone Height:</code> button.</p>

<h3>
<a id="dictionary-correction" class="anchor" href="#dictionary-correction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dictionary Correction</h3>

<h4>
<a id="enabling-dictionary-correction" class="anchor" href="#enabling-dictionary-correction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enabling Dictionary Correction</h4>

<p>To enable dictionary correction press the <code>Enable</code> button in the <code>Dictionary Corrections</code> Section of the toolbar/Ribbon. By default there are no corrections, you can see the avaliable corrections, by pressing the <code>Edit Dictionary</code> in the <code>Dictionary Corrections</code> section. To import a tone corrections dictionary, or make yourown, see below.</p>

<h4>
<a id="editing-the-corrections-dictionary" class="anchor" href="#editing-the-corrections-dictionary" aria-hidden="true"><span class="octicon octicon-link"></span></a>Editing the Corrections Dictionary</h4>

<p>To open the Dictionary Corrections window press the <code>Edit Dictionary</code> button.</p>

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/DictionaryCorrections.png" alt="">

<p>Press the <code>Done</code> button to close the window saving changes. </p>

<h5>
<a id="adding-words" class="anchor" href="#adding-words" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding Words</h5>

<p>To add a correction, type the chinese characters in the box containing <code>汉字</code> and the pinyin, separated by character by spaces, postfixed with the tone graph number, in the <code>han4 zi4</code> box. Then press the <code>Add</code> button and it should be copied into the list. See the above window for examples.</p>

<p>For multiple pronuciations add the same chinese characters twice, with different pronunciations.</p>

<h5>
<a id="deleting-words" class="anchor" href="#deleting-words" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deleting Words</h5>

<p>To delete words, select the large grey box to the left of the row you wish to delete, and press the delete key. There is no button in the window to do this.</p>

<h5>
<a id="editing-words" class="anchor" href="#editing-words" aria-hidden="true"><span class="octicon octicon-link"></span></a>Editing Words</h5>

<p>The words in the dictionary cannot be edited, to preven errors in the program. To edit one delete it, and add the corrected version.</p>

<h5>
<a id="enablingdisabling-words" class="anchor" href="#enablingdisabling-words" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enabling/Disabling Words</h5>

<p>Words can be enabled or disabled individually, buy having the tickbox checked or unchecked, respectively.</p>

<h4>
<a id="importing-and-exporting" class="anchor" href="#importing-and-exporting" aria-hidden="true"><span class="octicon octicon-link"></span></a>Importing and Exporting</h4>

<p>Edits to the dictionary can be imported or exported, to enable sharing, by selecting an option in the <code>File</code> Menu.</p>

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/DictionaryCorrectionsImportExport.png" alt="">

<p>Currently there is no undo mechanism for this. The tone corrections file is a hidden file called <code>tghzToneCorrections.txt</code> in your personal user or home folder. The file can be backed up by exporting it (see below) or making a duplicate. Deleting this file should cause a new empty file.</p>

<h5>
<a id="importing" class="anchor" href="#importing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Importing</h5>

<p>To import a tone corrections file, press the <code>Edit Dictionary</code> button, and then <code>File -&gt; Import Dictionary Corrections File</code> from the menu bar in the <code>Dictionary Corrections</code> window. A file dialog box will appear allowing you to choose the file to import. Please be careful to select the correct file.</p>

<p>Here is my <a href="https://raw.githubusercontent.com/twighk/tghz-word-tone-annotator/master/Hanzi2TGHZRibbon/ToneCorrections.txt">Tone Corrections File</a>. To download it, right-click the hyperlink and choose <code>Save Link As...</code>, or similar.</p>

<h5>
<a id="exporting" class="anchor" href="#exporting" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exporting</h5>

<p>To export a tone corrections file, press the <code>Edit Dictionary</code> button, and then <code>File -&gt; Export Dictionary Corrections File</code> from the menu bar in the <code>Dictionary Corrections</code> window. A file dialog box will appear allowing you to choose where to export the file to.</p>

<h3>
<a id="colouring-tones" class="anchor" href="#colouring-tones" aria-hidden="true"><span class="octicon octicon-link"></span></a>Colouring Tones</h3>

<p>Tones/pinyin and/or characters can be coloured using the colour button. Tick the box(es) before adding tones or pinyin for the output to also be coloured.</p>

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/Welcome%20Color.png" alt="">

<h3>
<a id="converting-traditionalsimplified-characters" class="anchor" href="#converting-traditionalsimplified-characters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Converting Traditional/Simplified Characters</h3>

<p>To convert from traditional or simplified to simplified or traditional, select the text and press the <code>To Simplified</code> or <code>To Traditional</code> buttons, respectively.</p>

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/TraditionalSimplified.png" alt="">

<h3>
<a id="troubleshooting" class="anchor" href="#troubleshooting" aria-hidden="true"><span class="octicon octicon-link"></span></a>Troubleshooting</h3>

<p>If you have any problems, please feel free to <a href="http://www.google.com/recaptcha/mailhide/d?k=01mQf3KmE1mGHm1vIP541YEg==&c=M0ebLv9ye1RjVVWraxQtQUpmo5hN2NmexsBaDGvibxs=">email me</a>.</p>

<h4>
<a id="certificate-error" class="anchor" href="#certificate-error" aria-hidden="true"><span class="octicon octicon-link"></span></a>Certificate Error</h4>

<p>While running the setup file there may be a certificate error:</p>

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/certerrorgithub.png" alt="">

<p>, because it is installing from an untrusted location.</p>

<p>To fix this, <code>https://raw.githubusercontent.com</code> needs to be added to the list of trusted sites:</p>

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/certerrorfix.png" alt="">
<ol>
    <li>
        Open Internet Options from the start menu.
        <ul><li>Alternatively, Open Internet Explorer, and click the <code>Gear Icon</code> (top right corner) and then choose <code>Internet Options</code>.</li></ul>
    </li>
    <li>In the <code>Internet Options</code> window select <code>Security</code>.</li>
    <li>Then <code>Trusted Sites</code>.</li>
    <li>Then click the button that says <code>Sites</code>.</li>
    <li>
        In the <code>Trusted sites</code> window copy and paste:

        <p style="text-indent: 2em;"> <code>https://raw.githubusercontent.com</code></p>

        and <code>Add</code> it.

    </li>

</ol>

<p> It should now be possible to install the program. But beware, this will make your computer trust any content from github, not just this add-in. To be safe it should be removed after installation, but the program will not automatically update.</p>

<h3>
<a id="visual-studio-tools-for-office-solution-installer-error" class="anchor" href="#visual-studio-tools-for-office-solution-installer-error" aria-hidden="true"><span class="octicon octicon-link"></span></a>Visual Studio Tools for Office Solution Installer Error</h3>

<p>While running the setup file, there may be an error message with the <code>Visual Studio Tools for Office Solution Installer</code>.</p>

<img src="https://github.com/twighk/tghz-word-tone-annotator/raw/master/Images/VSTOInstaller.png" alt="">

<p>To fix this, please run the setup program as an administrator.</p>

<p>(This problem was seen on Windows 8.1)</p>

<h3>
<a id="other-problems" class="anchor" href="#other-problems" aria-hidden="true"><span class="octicon octicon-link"></span></a>Other Problems</h3>

<p>If there are any other problems with using or installing the software, please <a href="http://www.google.com/recaptcha/mailhide/d?k=01mQf3KmE1mGHm1vIP541YEg==&c=M0ebLv9ye1RjVVWraxQtQUpmo5hN2NmexsBaDGvibxs=">email me</a> or <a href="https://github.com/twighk/tghz-word-tone-annotator/issues">submit an issue</a>.</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> based on the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

  </body>
</html>
